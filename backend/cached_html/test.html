<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"
	content="initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width" />
<title>请完成登录 ws:117.82.230.9</title>
<link rel="icon" href="data:;base64,=">
<link rel="stylesheet" type="text/css"
	href="/new_index.css">
<link rel="stylesheet" type="text/css" href="/easyui/easyui.css"/>
<script type="text/javascript"
	src="/jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="/easyui/jquery.easyui.min.js"></script>
</head>
<body>
	<div class="pop">
		<p class="title">访问过于频繁，请登录后继续访问。 （117.82.230.9）</p>
		<div class="main">
			<div class="code_img">
				<span>请在五分钟内完成登录</span>
			</div>
			<div class="code_num">
				<input type="button" class="btn_tj" id="btnSubmit"
					 value="点击按钮进行登录">
			</div>
			<div class="toast_mess" id="errmsg"></div>
			<div id="onlineBtn" style="text-align: center;"><a onclick="javascript:$('#dlg').dialog('open')">点我反馈</a></div>
			<div id="ISDCaptcha"></div>
		</div>

		<div id="dlg" class="easyui-dialog" title="反馈内容" style="width:400px"
			 data-options="
				iconCls: 'icon-save',
				toolbar: '#dlg-toolbar',
				buttons: '#dlg-buttons',
				modal: true,
				closed: true
			">
		</div>
		<div id="dlg-toolbar" style="padding:5px 0">
			<table style="width:100%">
				<tr>
					<td style="text-align:left;padding-left:2px;padding-bottom:5px">
						<label>请输入联系方式：</label>
					</td>
				</tr>
				<tr>
					<td style="text-align:left;padding-left:20px;padding-bottom:5px">
						<input class="easyui-textbox" id="feedback-contact" data-options="prompt:'请输入手机号或者邮箱'" style="width:200px">
					</td>
				</tr>
				<tr>
					<td style="text-align:left;padding-left:2px;padding-bottom:5px">
						<label>请输入反馈内容：</label>
					</td>
				</tr>
				<tr>
					<td style="text-align:left;padding-left:20px">
						<input class="easyui-textbox" id="feedback-content" data-options="multiline:true,prompt:'请填写问题描述，以便我们及时为您解决问题'" style="width:200px;height: 100px">
					</td>
				</tr>
			</table>
		</div>
		<div id="dlg-buttons">
			<a href="javascript:void(0)" class="easyui-linkbutton" onclick="feedback('登录挑战页面反馈')">保存</a>
			<a href="javascript:void(0)" class="easyui-linkbutton" onclick="javascript:$('#dlg').dialog('close')">关闭</a>
		</div>
	</div>
	<div class="footer">
		©  <a href="http://www.58.com">58.COM</a> 	</div>
<input type="hidden" id="sessionId" value="" />
<input type="hidden" id="serialId" value="dc5d533bcc32013806bb3fe6f8d18ce1_4d258db8c7b2400783fe2018dcc0e6fc" />
<input type="hidden" id="code" value="-5" />
<input type="hidden" id="sign" value="bc26dcd790d67e1fca560ff34eadb55a" />
<input type="hidden" id="url" value="https://su.58.com/chuzu/" />
<input type="hidden" id="namespace" value="cloud_zufang_php_houselist" />
<input type="hidden" id="ip" value="117.82.230.9" />
<input type="hidden" id="platform" value="pc" />
</body>
<script type="text/javascript"
		src="//j1.58cdn.com.cn/git/teg-app-fe/passport-pc-ui/js/passport/challenge_pop_v20220928150739.js"></script>
<script type="text/javascript"
		src="//j1.58cdn.com.cn/git/teg-app-fe/passport-pc/js/home_pop_v20211127103728.js"></script>
<script type="text/javascript"
		src="/feedback.js"></script>
<script type="text/javascript">
$(document).ready(function() {
	//统计pv
	pv();

	var namespace = $("#namespace").val();
	var uuid = $("#uuid").val();
	var url = $("#url").val();
	var verify_code = $("#verify_code").val();
	var ip = $("#ip").val();
	var serialId = $("#serialId").val();
	var code = $("#code").val();
	var sign =$("#sign").val();
    var platform =$("#platform").val();

	respMessage = $.ajax({
		url : "/antibot/prelogin.do?"+new Date().getTime(),
		data :{serialId:serialId,code:code,sign:sign,url:url,namespace:namespace,platform:platform},
		type : "POST",
		async : true,
		success : function(results) {
            var parsedJson = jQuery.parseJSON(results);
            if(parsedJson.code === 0){
                $("#errmsg").html(parsedJson.msg);
                if(parsedJson.data!== null){
                    setInterval(function(){skip_to(parsedJson.data);},5000);
				}
			}else if(parsedJson.code === 1){
                check(parsedJson.data);
			}else if(parsedJson.code === 2){
                skip_to(parsedJson.data);
			}else{
                $("#errmsg").html("非法请求");
			}
        }

	});

    function check(data){
        if(data !== null){
            if(platform === 'pc'){
                btnSubmit.onclick = function () {
                    pop_init({
                        source: data.source,
                        path:data.callbackpath,
                        domain: data.domain,
                        biz: data.bizId,
                        skin:data.skin,
                        callback: pop_init_cb
                    })
                }
			}else if(platform === 'm'){
                const Location = "https://passport.58.com/m/login?path=" + encodeURIComponent(data.callbackpath) + "&source=" +
                    data.source + "&defaulttype=2";

                btnSubmit.onclick = function () {window.location.href = Location;}
            }else{
                const Location = "http://passport.58.com/login?path=" + encodeURIComponent(data.callbackpath) + "&source=" +
                    data.source + "&mobile=&uname=";

                btnSubmit.onclick = function () {window.location.href = Location;}
            }
        }else{
            $("#errmsg").html("非法请求");
		}
	}


	function pop_init_cb(res) {
        respMessage = $.ajax({
            url : "checklogin.do",
            data : {
                code : res.code,
                action : res.data.action,
                requesthost : res.requesthost,
                msg : res.msg,
				url	:url,
				serialId:serialId,
                namespace:namespace
            },
            type : "POST",
            async : true,
            success : function(results) {
                var parsedJson = jQuery.parseJSON(results);
                if (parsedJson.code === 1) {
                    skip_to(parsedJson.data);
                } else {
                    $("#errmsg").html(parsedJson.msg);

                }
            }
        });
    }

    function skip_to(data) {
        var redLocation = 'http://www.58.com';
        if(data !== null){
            redLocation = data;
        }
        if(redLocation.indexOf("http://")===-1 && redLocation.indexOf("https://")===-1){
            redLocation = "http://"+redLocation;
        }
        window.location.href = redLocation;
    }

	function pv () {
	    var params = {};
	    //Document对象数据
	    if(document) {
	        params.domain = document.domain || '';
	        params.url = document.URL || '';
	        params.title = document.title || '';
	        params.referrer = document.referrer || '';
	    }
	    //Window对象数据
	    if(window && window.screen) {
	        params.sh = window.screen.height || 0;
	        params.sw = window.screen.width || 0;
	        params.cd = window.screen.colorDepth || 0;
	    }
	    //navigator对象数据
	    if(navigator) {
	        params.lang = navigator.language || '';
	    }

	    // 其他参数
	    var date = new Date();
	    params.ltime = date.getTime() / 1000;
	    //拼接参数串
	    var args = '';
	    for(var i in params) {
	        if(args !== '') {
	            args += '&';
	        }
	        args += i + '=' + encodeURIComponent(params[i]);
	    }

	    //通过Image对象请求后端脚本
	    var img = new Image(1, 1);
	    img.src = '/fwdata/load.gif?' + args;
	}
});

</script>
</html>